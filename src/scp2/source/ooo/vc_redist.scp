/*************************************************************************
*
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * Copyright 2000, 2010 Oracle and/or its affiliates.
 *
 * OpenOffice.org - a multi-platform office productivity suite
 *
 * This file is part of OpenOffice.org.
 *
 * OpenOffice.org is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Lesser General Public License version 3
 * only, as published by the Free Software Foundation.
 *
 * OpenOffice.org is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Lesser General Public License version 3 for more details
 * (a copy is included in the LICENSE file that accompanied this code).
 *
 * You should have received a copy of the GNU Lesser General Public License
 * version 3 along with OpenOffice.org.  If not, see
 * <http://www.openoffice.org/license.html>
 * for a copy of the LGPLv3 License.
 *
************************************************************************/

#include "macros.inc"

#if defined(WITH_VC_REDIST)
WindowsCustomAction gid_Customaction_InstallRuntime
	Name = "InstallRuntime";
	Typ = "98";
	Source = "SystemFolder";
	Target = "[SourceDir]redist\vcredist_x86.exe /qb";
	Inbinarytable = 0;
    Styles = (NO_FILE);
	Assignment1 = ("InstallUISequence", "VersionNT >= 600 and VersionNT < 700 And OLDPRODUCTSSAMEMAJOR And Not REMOVE=\"ALL\" And Not PATCH", "ExecuteAction");
End

WindowsCustomAction gid_Customaction_InstallRuntime_X64
	Name = "InstallRuntimeX64";
	Typ = "98";
	Source = "SystemFolder";
	Target = "[SourceDir]redist\vcredist_x64.exe /qb";
	Inbinarytable = 0;
    Styles = (NO_FILE);
	Assignment1 = ("InstallUISequence", "Not REMOVE=\"ALL\" And Not PATCH And VersionNT64", "ExecuteAction");
End

ScpAction scp_Copy_vcredist_x86
  #if defined(BUILD_SPECIAL)
    Copy = "vcredist_x86_9.0.21022.218.exe";
  #else
    Copy = "vcredist_x86.exe";
  #endif
    Name = "vcredist_x86.exe";
    Subdir = "redist";
End

ScpAction scp_Copy_vcredist_x64
    Copy = "vcredist_x64.exe";
    Name = "vcredist_x64.exe";
    Subdir = "redist";
End
#endif
